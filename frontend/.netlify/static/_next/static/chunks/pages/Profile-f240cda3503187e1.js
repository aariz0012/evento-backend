(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{9536:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Profile",function(){return a(1697)}])},1697:function(e,t,a){"use strict";a.r(t);var n=a(1010),s=a(5766),r=a(2253),l=a(4932),i=a(1309),o=a(4586),c=a(7582),d=a(5893),u=a(7294),m=a(1664),h=a.n(m),x=a(8120),v=a(7066),b=a(2298),g=a(2920),p=a(9583),f=a(3495);t.default=function(){var e,t,a,m,y=(0,x.aC)(),j=y.user,N=y.isAuthenticated,w=y.logout,k=y.updateUserProfile,_=(0,i._)((0,u.useState)("bookings"),2),A=_[0],M=_[1],C=(0,i._)((0,u.useState)([]),2),S=C[0],E=C[1],D=(0,i._)((0,u.useState)([]),2),B=D[0],I=D[1],P=(0,i._)((0,u.useState)(!0),2),R=P[0],V=P[1],F=(0,i._)((0,u.useState)(null),2),J=F[0],z=F[1],T=(0,i._)((0,u.useState)(!1),2),X=T[0],Z=T[1],Y=(0,i._)((0,u.useState)({name:"",email:"",phone:"",avatar:""}),2),L=Y[0],U=Y[1];(0,u.useEffect)(function(){N&&j&&(U({name:j.name||"",email:j.email||"",phone:j.phone||"",avatar:j.avatar||""}),q())},[N,j]);var q=(e=(0,n._)(function(){var e,t;return(0,c.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),V(!0),[4,v.Z.get("".concat("https://evento-backend.onrender.com","/bookings/user"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})];case 1:return(e=a.sent()).data&&e.data.data&&E(e.data.data),[4,v.Z.get("".concat("https://evento-backend.onrender.com","/reviews/user"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})];case 2:return(t=a.sent()).data&&t.data.data&&I(t.data.data),V(!1),[3,4];case 3:return console.error("Error fetching user data:",a.sent()),z("Failed to load your profile data. Please try again later."),V(!1),[3,4];case 4:return[2]}})}),function(){return e.apply(this,arguments)}),O=function(e){var t=e.target,a=t.name,n=t.value;U((0,l._)((0,r._)({},L),(0,s._)({},a,n)))},Q=(t=(0,n._)(function(e){var t,a,n,s;return(0,c.Jh)(this,function(r){switch(r.label){case 0:e.preventDefault(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,v.Z.put("".concat("https://evento-backend.onrender.com","/users/profile"),L,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})];case 2:return(t=r.sent()).data&&t.data.data&&(k(t.data.data),g.Am.success("Profile updated successfully"),Z(!1)),[3,4];case 3:return console.error("Error updating profile:",a=r.sent()),g.Am.error((null===(n=a.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||"Failed to update profile"),[3,4];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),$=(a=(0,n._)(function(e){var t,a,n;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if(!window.confirm("Are you sure you want to cancel this booking? This action cannot be undone."))return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,v.Z.delete("".concat("https://evento-backend.onrender.com","/bookings/").concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})];case 2:return s.sent(),E(S.filter(function(t){return t._id!==e})),g.Am.success("Booking cancelled successfully"),[3,4];case 3:return console.error("Error cancelling booking:",t=s.sent()),g.Am.error((null===(a=t.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.message)||"Failed to cancel booking"),[3,4];case 4:return[2]}})}),function(e){return a.apply(this,arguments)}),G=(m=(0,n._)(function(e){var t,a,n;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if(!window.confirm("Are you sure you want to delete this review? This action cannot be undone."))return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,v.Z.delete("".concat("https://evento-backend.onrender.com","/reviews/").concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})];case 2:return s.sent(),I(B.filter(function(t){return t._id!==e})),g.Am.success("Review deleted successfully"),[3,4];case 3:return console.error("Error deleting review:",t=s.sent()),g.Am.error((null===(a=t.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.message)||"Failed to delete review"),[3,4];case 4:return[2]}})}),function(e){return m.apply(this,arguments)});return R?(0,d.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):J?(0,d.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,d.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,d.jsx)("p",{children:J})})}):(0,d.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"My Profile"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,d.jsx)("div",{className:"lg:col-span-1",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,d.jsxs)("div",{className:"text-center mb-6",children:[(0,d.jsx)("div",{className:"w-24 h-24 rounded-full bg-gray-300 mx-auto mb-4 overflow-hidden",children:L.avatar?(0,d.jsx)("img",{src:L.avatar,alt:L.name,className:"w-full h-full object-cover"}):(0,d.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-blue-500 text-white font-bold text-2xl",children:L.name.charAt(0).toUpperCase()})}),(0,d.jsx)("h2",{className:"text-xl font-semibold",children:L.name}),(0,d.jsx)("p",{className:"text-gray-600",children:(null==j?void 0:j.memberSince)?"Member since ".concat((0,b.default)(new Date(j.memberSince),"MMMM yyyy")):"Member"})]}),X?(0,d.jsxs)("form",{onSubmit:Q,children:[(0,d.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-gray-700 mb-1",children:"Name"}),(0,d.jsx)("input",{type:"text",name:"name",value:L.name,onChange:O,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-gray-700 mb-1",children:"Email"}),(0,d.jsx)("input",{type:"email",name:"email",value:L.email,onChange:O,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-gray-700 mb-1",children:"Phone"}),(0,d.jsx)("input",{type:"tel",name:"phone",value:L.phone,onChange:O,className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-gray-700 mb-1",children:"Avatar URL"}),(0,d.jsx)("input",{type:"url",name:"avatar",value:L.avatar,onChange:O,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"https://example.com/avatar.jpg"})]})]}),(0,d.jsxs)("div",{className:"flex space-x-2",children:[(0,d.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md transition duration-300 ease-in-out",children:"Save"}),(0,d.jsx)("button",{type:"button",onClick:function(){return Z(!1)},className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 px-4 rounded-md transition duration-300 ease-in-out",children:"Cancel"})]})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(p.Xws,{className:"text-gray-500 mr-3"}),(0,d.jsx)("span",{children:L.name})]}),(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(p.SRX,{className:"text-gray-500 mr-3"}),(0,d.jsx)("span",{children:L.email})]}),L.phone&&(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(p.I7T,{className:"text-gray-500 mr-3"}),(0,d.jsx)("span",{children:L.phone})]})]}),(0,d.jsx)("button",{onClick:function(){return Z(!0)},className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md transition duration-300 ease-in-out",children:"Edit Profile"})]}),(0,d.jsx)("div",{className:"mt-6 pt-6 border-t",children:(0,d.jsx)("button",{onClick:w,className:"w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-md transition duration-300 ease-in-out",children:"Logout"})})]})}),(0,d.jsx)("div",{className:"lg:col-span-3",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,d.jsxs)("div",{className:"flex border-b",children:[(0,d.jsx)("button",{className:"flex-1 py-3 px-4 text-center font-medium ".concat("bookings"===A?"bg-blue-50 text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-50"),onClick:function(){return M("bookings")},children:"My Bookings"}),(0,d.jsx)("button",{className:"flex-1 py-3 px-4 text-center font-medium ".concat("reviews"===A?"bg-blue-50 text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-50"),onClick:function(){return M("reviews")},children:"My Reviews"})]}),(0,d.jsxs)("div",{className:"p-6",children:["bookings"===A&&(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Bookings"}),0===S.length?(0,d.jsxs)("div",{className:"text-center py-8",children:[(0,d.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have any bookings yet."}),(0,d.jsx)(h(),{href:"/",className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-6 rounded-md transition duration-300 ease-in-out",children:"Explore Venues"})]}):(0,d.jsx)("div",{className:"space-y-6",children:S.map(function(e){var t,a;return(0,d.jsx)(f.E.div,{className:"border rounded-lg overflow-hidden",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4",children:[(0,d.jsx)("div",{className:"md:col-span-1 h-40 md:h-full bg-gray-200",children:e.venue&&e.venue.images&&e.venue.images.length>0?(0,d.jsx)("img",{src:e.venue.images[0],alt:e.venue.name,className:"w-full h-full object-cover"}):(0,d.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-300 text-gray-600",children:"No image"})}),(0,d.jsxs)("div",{className:"md:col-span-3 p-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-semibold",children:e.venue?e.venue.name:"Venue not available"}),e.venue&&e.venue.location&&(0,d.jsxs)("p",{className:"text-gray-600 flex items-center",children:[(0,d.jsx)(p.Nh4,{className:"mr-1"}),e.venue.location.city,", ",e.venue.location.state]})]}),(0,d.jsx)("div",{className:"text-right",children:(0,d.jsxs)("span",{className:"font-bold text-blue-600",children:["$",e.totalAmount.toFixed(2)]})})]}),(0,d.jsxs)("div",{className:"mt-3 flex items-center text-gray-600",children:[(0,d.jsx)(p.IiJ,{className:"mr-1"}),(0,d.jsxs)("span",{children:[(0,b.default)(new Date(e.startDate),"MMM dd, yyyy")," - ",(0,b.default)(new Date(e.endDate),"MMM dd, yyyy")]})]}),(0,d.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2",children:[(0,d.jsx)(h(),{href:"/venues/".concat(null===(t=e.venue)||void 0===t?void 0:t._id),className:"bg-blue-100 hover:bg-blue-200 text-blue-800 py-1 px-3 rounded-md text-sm transition duration-300 ease-in-out",children:"View Venue"}),new Date(e.startDate)>new Date&&(0,d.jsx)("button",{onClick:function(){return $(e._id)},className:"bg-red-100 hover:bg-red-200 text-red-800 py-1 px-3 rounded-md text-sm transition duration-300 ease-in-out",children:"Cancel Booking"}),new Date(e.endDate)<new Date&&!e.hasReview&&(0,d.jsx)(h(),{href:"/reviews/new?venueId=".concat(null===(a=e.venue)||void 0===a?void 0:a._id,"&bookingId=").concat(e._id),className:"bg-green-100 hover:bg-green-200 text-green-800 py-1 px-3 rounded-md text-sm transition duration-300 ease-in-out",children:"Leave Review"})]})]})]})},e._id)})})]}),"reviews"===A&&(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Reviews"}),0===B.length?(0,d.jsx)("div",{className:"text-center py-8",children:(0,d.jsx)("p",{className:"text-gray-600",children:"You haven't left any reviews yet."})}):(0,d.jsx)("div",{className:"space-y-6",children:B.map(function(e){return(0,d.jsxs)(f.E.div,{className:"border rounded-lg p-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[(0,d.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-semibold",children:e.venue?e.venue.name:"Venue not available"}),(0,d.jsxs)("div",{className:"flex items-center mt-1",children:[(0,d.jsx)("div",{className:"flex",children:(0,o._)([,,,,,]).map(function(t,a){return(0,d.jsx)(p.QJe,{className:a<e.rating?"text-yellow-400":"text-gray-300"},a)})}),(0,d.jsx)("span",{className:"ml-2 text-gray-600",children:(0,b.default)(new Date(e.createdAt),"MMM dd, yyyy")})]})]}),(0,d.jsx)("button",{onClick:function(){return G(e._id)},className:"text-red-600 hover:text-red-800",title:"Delete review",children:(0,d.jsx)(p.Xm5,{})})]}),(0,d.jsx)("p",{className:"text-gray-700",children:e.comment}),e.venue&&(0,d.jsx)(h(),{href:"/venues/".concat(e.venue._id),className:"inline-block mt-3 text-blue-600 hover:underline text-sm",children:"View Venue"})]},e._id)})})]})]})]})})]})]})}}},function(e){e.O(0,[445,949,298,774,888,179],function(){return e(e.s=9536)}),_N_E=e.O()}]);